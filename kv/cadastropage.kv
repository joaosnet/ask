# Definição da tela de cadastro de usuários
<CadastroPage>:
    # é uma tela de login que contempla a autenticação de usuários e a criação de novos usuários.

    # Layout principal da tela
    MDBoxLayout:
        orientation: 'vertical'
        padding: 15,20,15,25
        spacing: 25

        # Botão para voltar para a tela inicial
        MDIconButton:
            pos_hint: {'center_x': 0.05,'center_y': 1}
            icon: 'icones/Expand_left@3x.png'
            icon_size: "45sp"
            on_release: app.mudar_tela('startpage')
            
        # Título da tela
        MDLabel:
            text: 'Cadastre-se'
            font_size: '24sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            bold: True
            halign: 'left'

        # Descrição da tela
        MDLabel:
            text: 'Crie uma nova conta usando seu email'
            font_size: '16sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'left'

        # Campo para informar o nome do usuário
        MDLabel:
            text: 'Informe seu nome'
            font_size: '12sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'left'
        MDTextField:
            id: nome
            mode: "fill"
            hint_text: 'Nome'
            helper_text: 'Informe seu nome completo'
            helper_text_mode: 'on_focus'
            fill_color_normal: "#EDF1FF"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            size_hint_x: None
            width: 320
            radius: [5, 5, 5, 5]

        # Campo para informar o email do usuário
        MDLabel:
            text: 'Informe seu email'
            font_size: '12sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'left'
        MDTextField:
            id: email
            mode: "fill"
            hint_text: 'Email'
            helper_text: 'O email deve ser válido'
            helper_text_mode: 'on_focus'
            icon_right: 'email'
            # cores
            icon_right_color: app.theme_cls.primary_color
            fill_color_normal: "#EDF1FF"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            size_hint_x: None
            width: 320
            radius: [5, 5, 5, 5]
            validator: "email"

        # Campo para informar a senha do usuário
        MDLabel:
            text: 'Informe sua senha'
            font_size: '12sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'left'
        ClickableTextFieldRound:
            id: senha_sem_confirmacao
            size_hint_x: None
            width: "300dp"
            hint_text: "Senha"
            pos_hint: {"center_x": .5, "center_y": .5}
            helper_text_mode: "on_error"

        # Campo para confirmar a senha do usuário
        MDLabel:
            text: 'Confirme sua senha'
            font_size: '12sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'left'
        ClickableTextFieldRound:
            id: senha_de_confirmacao
            size_hint_x: None
            width: "300dp"
            hint_text: "Senha"
            pos_hint: {"center_x": .5, "center_y": .5}
            helper_text_mode: "on_error"

        # Botão para cadastrar o usuário
        MDRectangleFlatButton:
            text: 'Cadastrar'
            font_size: '18sp'
            # TEXTO DE COR BRANCA
            theme_text_color: 'Custom'
            text_color: 1, 1, 1, 1
            # cor do fundo do botao
            md_bg_color: "#8C52FF"
            # Cor da borda do botão
            line_color: "#8C52FF"
            # tamanho do botao
            size_hint: 1, "1.2dp"
            # quando clicado confirma a senha e faz o cadastro, quando não, mostra uma mensagem de erro nos campos senha e confirmação de senha
            on_release: app.firebase.confirmar_senha(nome.text, email.text, senha_sem_confirmacao.ids.text_field.text, senha_de_confirmacao.ids.text_field.text)

        # Divisão horizontal
        MDBoxLayout:
            orientation: 'horizontal'
            padding: 10,0,10,0
            spacing: 0
            Image:
                source: 'icones/Line 3.png'
                size_hint_x: None
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            MDLabel:
                text: 'Ou cadastre-se com'
                font_size: '12sp'
                # TEXTO DE COR PRETA
                color: 0, 0, 0, 1
                halign: 'center'
                size_hint_y: 1
            Image:
                source: 'icones/Line 2.png'
                size_hint_x: None
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        # Botões para cadastro com Google e Facebook
        MDBoxLayout:
            orientation: 'horizontal'
            padding: 100,0,100,0
            spacing: 0
            MDIconButton:
                icon: 'icones/bt_google.png'
                icon_size: "45sp"
                pos_hint: {'center_x': 0.5,'center_y': 0.5}
            MDIconButton:
                icon: 'icones/bt_facebook.png'
                icon_size: "45sp"
                pos_hint: {'center_x': 0.5,'center_y': 0.5}

        # Para mostrar a mesagem de erro generica
        MDLabel:
            id: mensagem_erro
            text: ''
            font_size: '12sp'
            # TEXTO DE COR PRETA
            color: 0, 0, 0, 1
            halign: 'center'
        # Divisão vertical
        MDBoxLayout:
            orientation: 'vertical'
            spacing: 15

            # Termos e condições
            MDBoxLayout:
                orientation: 'horizontal'
                # centralizando
                padding: 10,0,10,0
                spacing: 0
                MDLabel:
                    text:"Ao me registrar, concordo com os"
                    font_size: 12
                    valign: 'center'
                    halign: 'right'
                MDFlatButton:
                    text: "[color=#8C52FF]termos e condições[/color]"
                    font_size: 12
                    markup: True
                    pos_hint: {"center_x": .5, "center_y": .5}

            # Texto final
            MDLabel:
                text:"do InclusiveWAY."
                font_size: 12
                valign: 'center'
                halign: 'center'

        # Divisão horizontal
        MDBoxLayout:
            orientation: 'horizontal'
            # centralizando
            padding: 50,0,50,0
            MDLabel:
                text:"já tem uma conta?"
                font_size: 12
                valign: 'center'
                halign: 'right'
            MDFlatButton:
                text: "[color=#8C52FF]Faça Login[/color]"
                font_size: 12
                markup: True
                pos_hint: {"center_x": .5, "center_y": .5}
                on_release: app.mudar_tela('loginpage')

# Função para mostrar a senha ou ocultar a senha
<ClickableTextFieldRound>:
    size_hint_y: None
    height: text_field.height

    MDTextField:
        id: text_field
        text: root.text
        mode: "fill"
        hint_text: root.hint_text
        # cores
        fill_color_normal: "#EDF1FF"
        helper_text: 'A senha deve conter no mínimo 6 caracteres'
        helper_text_mode: 'on_focus'
        # usando o icone direito para mostrar a senha o ocultar a senha
        radius: [5, 5, 5, 5]
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        size_hint_x: None
        width: 320
        password: True

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: text_field.width - self.width - dp(5), 0
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            text_field.password = False if text_field.password is True else True
        
CadastroPage: